"use strict";Array.prototype.indexOf=Array.prototype.indexOf||function(b,d){for(var c=0,a=b.length;c<a;c++){if(b[c]===d){return c}}return -1};var objectRegExp=/^\[object (\S+)\]$/,toString=Object.prototype.toString,slice=Array.prototype.slice,noop=function(){},handlers={},assets={},PRELOADING=1,PRELOADED=2,LOADING=3,LOADED=4,isDomReady;var isCss=new RegExp("\\.css"),isAsync="async" in doc.createElement("script")||"MozAppearance" in doc.documentElement.style||global.opera,body=doc.getElementsByTagName("body")[0];function getType(b){var a=typeof b;if(a!=="object"){return a}return toString.call(b).replace(objectRegExp,"$1").toLowerCase()}function each(a,e,d){d=d||null;if(!a){return}if(typeof a==="object"){a=[].slice.call(a)}for(var c=0,b=a.length;c<b;c++){e.call(d,a[c],c)}}function one(a){a=a||noop;if(a._done){return}a();a._done=1}function toLabel(c){var a=c.split("/"),b=a[a.length-1],d=b.indexOf("?");return d!==-1?b.substring(0,d):b}var Loader=function(d,c,a){if(!(this instanceof Loader)){return new Loader(d,c,a)}var b=arguments;if(!b[1]||typeof b[1]==="function"){b[1]=false;b[2]=function(){}}b[0]=getType(b[0])==="array"?b[0]:[b[0]];b[2]=b[2]||function(){};this.init.apply(this,b)};Loader.prototype.init=function(c,b,a){if(!c.length){return a()}this.ready(function(){this[isAsync?"loadAsync":"loadHack"](c,a)})};Loader.prototype.preLoad=function(a,b){if(a.state===undefined){a.state=PRELOADING;a.onpreload=[];this.loadAsset({url:a.url,type:"cache"},function(){this.onPreload(a)})}};Loader.prototype.allLoaded=function(a){a=a||assets;for(var b in a){if(a.hasOwnProperty(b)&&a[b].state!==LOADED){return false}}return true};Loader.prototype.onPreload=function(a){a.state=PRELOADED;each(a.onpreload,function(b){b.call(this)},this)};Loader.prototype.getAsset=function(d){var b={};if(typeof d==="object"){for(var a in d){if(!!d[a]){b={name:a,url:d[a]}}}}else{b={name:toLabel(d),url:d}}var c=assets[b.name];if(c&&c.url===b.url){return c}assets[b.name]=b;return b};Loader.prototype.loadHack=function loadHack(){var a=arguments,d=a[a.length-1],c=[].slice.call(a,1),b=c[0];if(!(getType(d)==="function")){d=null}if(getType(a[0])==="array"){a[0].push(d);loadHack.apply(this,a[0]);return}if(!!b){each(c,function(e){if((!getType(e)==="function")&&!!e){this.preLoad(this.getAsset(e))}},this);this.load(this.getAsset(a[0]),getType(b)==="function"?b:function(){loadHack.apply(this,c)})}else{this.load(this.getAsset(a[0]))}};Loader.prototype.loadAsync=function loadAsync(){var b=arguments,c=b[b.length-1],a={};if(!(getType(c)==="function")){c=null}if(getType(b[0])==="array"){b[0].push(c);loadAsync.apply(this,b[0]);return}each(b,function(e,d){if(e!==c){a[e.name]=e;e=this.getAsset(e)}},this);each(b,function(e,d){if(e!==c){e=this.getAsset(e);this.load(e,function(){if(this.allLoaded(a)){one(c)}})}},this)};Loader.prototype.load=function(a,c){var b=this;c=c||noop;if(a.state===LOADED){c.call(b);return}if(a.state===PRELOADING){a.onpreload.push(function(){this.load(a,c)});return}a.state=LOADING;this.loadAsset(a,function(){a.state=LOADED;c.call(b);each(handlers[a.name],function(d){one(d)});if(isDomReady&&this.allLoaded()){each(handlers.ALL,function(d){one(d)})}})};Loader.prototype.loadAsset=function(d,h){h=h||noop;var i,e=this;function f(j){j=j||global.event;i.onload=i.onreadystatechange=i.onerror=null;h.call(e)}function a(j){j=j||global.event;if(j.type==="load"||(/loaded|complete/.test(i.readyState)&&(!doc.documentMode||doc.documentMode<9))){global.clearTimeout(d.errorTimeout);global.clearTimeout(d.cssTimeout);i.onload=i.onreadystatechange=i.onerror=null;h.call(e)}}function c(){if(d.state!==LOADED&&d.cssRetries<=20){for(var k=0,j=doc.styleSheets.length;k<j;k++){if(doc.styleSheets[k].href===i.href){a({type:"load"});return}}d.cssRetries++;d.cssTimeout=global.setTimeout(c,250)}}function g(){i=doc.createElement("link");i.type="text/"+(d.type||"css");i.rel="stylesheet";i.href=d.url;d.cssRetries=0;d.cssTimeout=global.setTimeout(c,500)}function b(){i=doc.createElement("script");i.type="text/"+(d.type||"javascript");i.src=d.url}isCss.test(d.url)?g():b();i.onload=i.onreadystatechange=a;i.onerror=f;i.async=false;i.defer=false;d.errorTimeout=global.setTimeout(function(){f({type:"timeout"})},7000);body.appendChild(i)};Loader.prototype.ready=function(b){var h=this;function c(){if(!doc.body){global.clearTimeout(h.readyTimeout);h.readyTimeout=global.setTimeout(c,50);return}if(!isDomReady){isDomReady=true;b.call(h)}}function g(){if(doc.addEventListener){doc.removeEventListener("DOMContentLoaded",g,false);c()}else{if(doc.readyState==="complete"){doc.detachEvent("onreadystatechange",g);c()}}}if(doc.readyState==="complete"){c()}else{if(doc.addEventListener){doc.addEventListener("DOMContentLoaded",g,false);global.addEventListener("load",c,false)}else{doc.attachEvent("onreadystatechange",g);global.attachEvent("onload",c);var f=false;try{f=!global.frameElement&&doc.documentElement}catch(d){}if(f&&f.doScroll){(function a(){if(!isDomReady){try{f.doScroll("left")}catch(e){global.clearTimeout(h.readyTimeout);h.readyTimeout=global.setTimeout(a,50);return}c()}}())}}}};